<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dreamtree.api.domain.category.mapper.CategoryMapper">
    <resultMap id="categoryList" type="categoryListDTO">
        <id column="category_id" />
        <result property="categoryName" column="category_name"/>
        <collection property="subCategoryNames" javaType="java.util.ArrayList" resultMap="subCategoryList" />
    </resultMap>

    <resultMap id="subCategoryList" type="string">
        <result column="sub_category_name" />
    </resultMap>

    <select id="getCategories" resultMap="categoryList">
        select
            cat.category_id as category_id,
            cat.name as category_name,
            sub.name as sub_category_name
        from tbl_category cat
        left join tbl_sub_category sub
            on sub.category_id = cat.category_id
        where cat.deletedAt is null
            and sub.deletedAt is null
    </select>
</mapper>